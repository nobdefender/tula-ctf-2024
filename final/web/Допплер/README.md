# Допплер

## Условие

Известный шеф-повар В. ресторана "213 звезд Кама" уехал на слёт в Ярославль. 
Тем временем в его ресторан нагрянул известный критик Г.Б. и чтобы скрыть отсутствие шеф-повара управляющая решила выдать гостя за него. 
Гостью пришлось найти спрятанный нож шефа и приготовить **4** курицы. 
На ноже была гравировка *1+2+3=совершенство*


## Решение

Исследуем сайт на наличие скрытых элементов, находим скрытую кнопка для получения флага, убираем поле *display:none*. Кликаем на кнопку вызывается модальное окно для ввода id, но необходимо быть обладать права администратора, для этого необходимо поменять поле *role* в JWT-токене. Скачиваем словарь для подбора секретного ключа JWT-токена, открываем Hashcat, передаем в него выданный сервером токен и словарь. В результате получаем ключ *aLongSecretStringWhoseBitnessIsEqualToOrGreaterThanTheBitnessOfTheTokenEncryptionAlgorithm*, вставляем его в соответствующее поле на сайте jwt.io, меняем роль и готово, в куки вписываем измененный токен.

Теперь мы можем делать запросы в модальном окне, тут необходимо воспользоваться SQL-инъекцией. Из таблицы flags нужно получить флаг, в описании задания говорится *"1+2+3=совершенство"* и *"4 курицы"*, значит нам нужно взять первые 4 совершенных числа: 6, 28, 496, 8128. Изменяем максимальное количество символов в поле ввода и вводим инъекцию
> 1' UNION SELECT * FROM flags WHERE id = '6' OR id = '28' OR id = '496' OR id = '8128

В пришедшем ответе от сервера будет 4 части флага.

## Flag 
```TulaCTF{U_nas_sejchas_na_obed_kotlekti_S_makaroshkami?_S_pyureeeshkoooj!}```


